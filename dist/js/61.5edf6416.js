"use strict";(self["webpackChunkmusic"]=self["webpackChunkmusic"]||[]).push([[61],{61:function(e,t,n){n.r(t),n.d(t,{default:function(){return k}});var r=n(2229),o=(n(8228),n(168)),s=(n(4165),n(311));const l={class:"play"},c={class:"header"},i={class:"song-wrapper"},a={class:"song-img"},d=["src"],u={class:"song-start"},m={class:"song-msg"},y={class:"m-song-h2"},g={class:"m-song-sname"},h={class:"lyricContent"};function p(e,t,n,p,f,v){const S=o.J,E=r.g;return(0,s.openBlock)(),(0,s.createElementBlock)("div",l,[(0,s.createElementVNode)("div",{class:"song-bg",style:(0,s.normalizeStyle)(`background-image: url(${v.songInfo.picUrl})`)},null,4),(0,s.createElementVNode)("div",c,[(0,s.createVNode)(S,{name:"arrow-down",size:"20",class:"left-incon",onClick:v.fold},null,8,["onClick"])]),(0,s.createElementVNode)("div",i,[(0,s.createElementVNode)("div",{class:"song-turn ani",style:(0,s.normalizeStyle)("animation-play-state:"+(v.isPlaying?"running":"paused"))},[(0,s.createElementVNode)("div",a,[(0,s.createElementVNode)("img",{style:{width:"100%"},src:v.songInfo.picUrl,alt:""},null,8,d)])],4),(0,s.createElementVNode)("div",{class:"start-box",onClick:t[0]||(t[0]=function(){return v.audioStart&&v.audioStart(...arguments)})},[(0,s.withDirectives)((0,s.createElementVNode)("span",u,null,512),[[s.vShow,!v.isPlaying]])]),(0,s.createElementVNode)("div",m,[(0,s.createElementVNode)("div",y,[(0,s.createElementVNode)("span",g,(0,s.toDisplayString)(v.songInfo.name)+" - "+(0,s.toDisplayString)(v.songInfo.author),1)]),(0,s.withDirectives)((0,s.createVNode)(E,{class:"play-loading",vertical:""},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)(" 加载中... ")])),_:1},512),[[s.vShow,0==f.lyricContent.length]]),(0,s.createElementVNode)("div",h,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(f.lyricContent,((e,t)=>((0,s.openBlock)(),(0,s.createElementBlock)("div",{class:(0,s.normalizeClass)(["lyric",{curLyric:e===f.curLyric}]),key:t},(0,s.toDisplayString)(e.replace(/\[.+?\]/,"")),3)))),128))])]),(0,s.createElementVNode)("div",{class:"needle",style:(0,s.normalizeStyle)(`transform: rotate(${v.needleDeg});`)},null,4)])])}var f=n(8737),v={components:{},name:"full-screen-play",data(){return{lyric:{},lyricContent:[],curLyric:""}},created(){const e=document.getElementById("audio");e.controls=!0,0==e.currentTime&&this.isPlaying&&e.play()},computed:{currentId(){return this.$store.state.currentId},isPlaying(){return this.$store.state.isPlaying},songInfo(){return this.$store.state.currentSongInfo},needleDeg(){return this.isPlaying?"2deg":"-20deg"}},watch:{curLyric(){this.$nextTick((()=>this.scrollLyric()))}},methods:{fold(){this.$store.commit("setFullScreen",!1),this.$router.back()},async getSongLyr(){const e=await(0,f.O3)({id:this.currentId,realIP:"116.25.146.177"}),t=e.data.lrc.lyric;this.lyric=this.formatLyr(t),this.showLyric()},formatLyr(e){const t=/\[.+?\]/g;let n=e.match(t),r=e.split(/\[.+?\]/).slice(1),o=0;for(let l=0;l<r.length;l++)""!=r[l].trim()&&(this.lyricContent[o]="["+o+"]"+r[l],n[o]=n[l],o++);n=n.slice(0,o);const s={};return n.forEach(((e,t)=>{const n=60*(10*e[1]+ +e[2]),r=10*e[4]+ +e[5];s[n+r]=this.lyricContent[t]})),s},audioStart(){const e=document.querySelector("#audio");this.isPlaying?e.pause():e.play(),this.$store.commit("setPlayingState",!this.isPlaying)},showLyric(){const e=document.querySelector("#audio");e.addEventListener("timeupdate",(()=>{let t=Math.floor(e.currentTime-.2);this.lyric[t]&&(this.curLyric=this.lyric[t])}))},scrollLyric(){let e=document.querySelector(".curLyric"),t=document.querySelector(".lyricContent");e.offsetTop-t.scrollTop>=99&&(t.scrollTop=e.offsetTop-66),e.offsetTop<t.scrollTop&&(t.scrollTop=e.offsetTop)}},mounted(){this.getSongLyr()},unmounted(){const e=document.querySelector("#audio");e.controls=!1,this.$store.commit("setFullScreen",!1)}},S=n(7477);const E=(0,S.Z)(v,[["render",p],["__scopeId","data-v-8e9985ea"]]);var k=E}}]);